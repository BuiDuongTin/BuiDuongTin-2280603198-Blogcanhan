<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lập trình bất đồng bộ trong JavaScript với Promise và Async/Await - Bùi Dương Tin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
</head>
<body>
    <!-- Header & Navigation -->
    <header>
        <div class="container">
            <div class="logo">
                <a href="../index.html">BDT<span>Code</span></a>
            </div>
            <nav>
                <ul class="nav-links">
                    <li><a href="../index.html">Trang chủ</a></li>
                    <li><a href="../blog.html" class="active">Blog</a></li>
                </ul>
                <div class="hamburger">
                    <div class="line"></div>
                    <div class="line"></div>
                    <div class="line"></div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Post Header -->
    <section class="post-header">
        <div class="container">
            <h1>Lập trình bất đồng bộ trong JavaScript với Promise và Async/Await</h1>
            <div class="post-meta">
                <span><i class="far fa-calendar"></i> 10/10/2025</span>
                <span><i class="far fa-clock"></i> 12 phút đọc</span>
                <span><i class="far fa-folder"></i> JavaScript</span>
            </div>
        </div>
    </section>

    <!-- Post Content -->
    <section class="post-content">
        <div class="container">
            <div class="post-image">
                <img src="../images/post-2.jpg" alt="JavaScript Asynchronous Programming">
            </div>
            
            <div class="content">
                <h2>Giới thiệu về lập trình bất đồng bộ</h2>
                <p>
                    JavaScript là một ngôn ngữ lập trình đơn luồng (single-threaded), có nghĩa là nó chỉ có thể thực thi một công việc tại một thời điểm. 
                    Tuy nhiên, nhờ vào khả năng lập trình bất đồng bộ, JavaScript có thể xử lý nhiều tác vụ mà không làm chương trình bị chặn hoặc 
                    "đóng băng".
                </p>
                
                <p>
                    Trong bài viết này, chúng ta sẽ khám phá hai cách tiếp cận hiện đại nhất để xử lý code bất đồng bộ trong JavaScript: 
                    Promise và Async/Await. Những kỹ thuật này giúp code của bạn dễ đọc, dễ bảo trì và tránh được "callback hell".
                </p>

                <h2>Từ Callback đến Promise</h2>
                <p>
                    Trước khi có Promise, callback là phương pháp chính để xử lý các tác vụ bất đồng bộ trong JavaScript. Tuy nhiên, 
                    callback có nhiều hạn chế, đặc biệt là khi bạn cần thực hiện nhiều tác vụ bất đồng bộ liên tiếp.
                </p>
                
                <h3>Callback Hell</h3>
                <p>
                    Hãy xem một ví dụ kinh điển về "callback hell":
                </p>
                
                <pre><code class="language-javascript">
getUser(userId, function(user) {
    getUserPosts(user.id, function(posts) {
        getPostComments(posts[0].id, function(comments) {
            displayComments(comments, function() {
                console.log('Comments displayed');
                // Và còn nhiều callback lồng nhau nữa...
            });
        });
    });
});
                </code></pre>
                
                <p>
                    Như bạn thấy, code trở nên khó đọc và khó bảo trì với nhiều callback lồng nhau. Đây chính là lý do Promise ra đời.
                </p>
                
                <h2>Promise trong JavaScript</h2>
                <p>
                    Promise là một đối tượng đại diện cho kết quả của một tác vụ bất đồng bộ. Nó có thể ở một trong ba trạng thái:
                </p>
                <ul>
                    <li><strong>Pending</strong>: Trạng thái ban đầu, tác vụ chưa hoàn thành hoặc bị từ chối</li>
                    <li><strong>Fulfilled</strong>: Tác vụ đã hoàn thành thành công</li>
                    <li><strong>Rejected</strong>: Tác vụ bị lỗi hoặc bị từ chối</li>
                </ul>
                
                <h3>Tạo và sử dụng Promise</h3>
                <p>
                    Đây là cách tạo một Promise đơn giản:
                </p>
                
                <pre><code class="language-javascript">
const myPromise = new Promise((resolve, reject) => {
    // Thực hiện tác vụ bất đồng bộ
    setTimeout(() => {
        const success = true;
        
        if (success) {
            resolve('Tác vụ hoàn thành thành công!');
        } else {
            reject('Có lỗi xảy ra!');
        }
    }, 2000);
});

// Sử dụng Promise
myPromise
    .then(result => {
        console.log(result); // Output: Tác vụ hoàn thành thành công!
    })
    .catch(error => {
        console.error(error);
    })
    .finally(() => {
        console.log('Promise đã xử lý xong, bất kể thành công hay thất bại');
    });
                </code></pre>
                
                <h3>Chuỗi Promise</h3>
                <p>
                    Một trong những lợi ích lớn nhất của Promise là khả năng chuỗi các tác vụ bất đồng bộ mà không cần lồng callback:
                </p>
                
                <pre><code class="language-javascript">
getUser(userId)
    .then(user => getUserPosts(user.id))
    .then(posts => getPostComments(posts[0].id))
    .then(comments => displayComments(comments))
    .then(() => console.log('Comments displayed'))
    .catch(error => console.error('Có lỗi xảy ra:', error));
                </code></pre>
                
                <p>
                    Như bạn thấy, code trở nên phẳng hơn và dễ đọc hơn nhiều so với phiên bản callback.
                </p>
                
                <h3>Promise.all() và Promise.race()</h3>
                <p>
                    JavaScript cũng cung cấp các phương thức hữu ích để làm việc với nhiều Promise:
                </p>
                
                <pre><code class="language-javascript">
// Promise.all() - chờ tất cả Promise hoàn thành
const promises = [
    fetchUser(),
    fetchPosts(),
    fetchComments()
];

Promise.all(promises)
    .then(([user, posts, comments]) => {
        // Xử lý khi cả 3 Promise đều hoàn thành
        console.log(user, posts, comments);
    })
    .catch(error => {
        // Nếu bất kỳ Promise nào bị lỗi
        console.error(error);
    });

// Promise.race() - trả về Promise đầu tiên hoàn thành (hoặc bị lỗi)
Promise.race([
    fetchDataFromAPI1(),
    fetchDataFromAPI2()
])
    .then(result => {
        console.log('API nhanh nhất trả về:', result);
    })
    .catch(error => {
        console.error('API đầu tiên bị lỗi:', error);
    });
                </code></pre>
                
                <h2>Async/Await - Cú pháp hiện đại hơn</h2>
                <p>
                    Mặc dù Promise đã cải thiện đáng kể cách chúng ta viết code bất đồng bộ, nhưng ES2017 giới thiệu 
                    Async/Await giúp code trở nên thậm chí còn dễ đọc hơn, gần giống với code đồng bộ thông thường.
                </p>
                
                <h3>Cú pháp cơ bản</h3>
                <pre><code class="language-javascript">
async function fetchUserData() {
    try {
        const user = await getUser(userId);
        const posts = await getUserPosts(user.id);
        const comments = await getPostComments(posts[0].id);
        await displayComments(comments);
        console.log('Comments displayed');
    } catch (error) {
        console.error('Có lỗi xảy ra:', error);
    }
}

// Gọi hàm async
fetchUserData();
                </code></pre>
                
                <p>
                    Với Async/Await, code trở nên rõ ràng và dễ hiểu hơn rất nhiều. Từ khóa <code>async</code> đánh dấu 
                    một hàm là bất đồng bộ, và từ khóa <code>await</code> được sử dụng để chờ Promise hoàn thành.
                </p>
                
                <h3>Xử lý lỗi với try/catch</h3>
                <p>
                    Một lợi ích khác của Async/Await là khả năng sử dụng khối try/catch thông thường để xử lý lỗi, 
                    thay vì sử dụng .catch() như với Promise.
                </p>
                
                <h3>Thực thi song song</h3>
                <p>
                    Mặc dù Async/Await giúp code trông giống như đồng bộ, nhưng chúng ta vẫn có thể thực hiện các tác vụ song song 
                    khi cần thiết:
                </p>
                
                <pre><code class="language-javascript">
async function fetchAllData() {
    try {
        // Thực thi song song 3 Promise
        const [user, posts, comments] = await Promise.all([
            fetchUser(),
            fetchPosts(),
            fetchComments()
        ]);
        
        console.log(user, posts, comments);
    } catch (error) {
        console.error('Có lỗi xảy ra:', error);
    }
}
                </code></pre>
                
                <h2>So sánh Promise và Async/Await</h2>
                
                <table border="1" style="width:100%; border-collapse: collapse; margin: 20px 0;">
                    <tr style="background-color: #f8f9fa;">
                        <th style="padding: 10px; text-align: left;">Tiêu chí</th>
                        <th style="padding: 10px; text-align: left;">Promise</th>
                        <th style="padding: 10px; text-align: left;">Async/Await</th>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Cú pháp</td>
                        <td style="padding: 10px;">Chuỗi .then() và .catch()</td>
                        <td style="padding: 10px;">Giống code đồng bộ với try/catch</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Độ phức tạp</td>
                        <td style="padding: 10px;">Phức tạp hơn với nhiều .then()</td>
                        <td style="padding: 10px;">Đơn giản, dễ đọc hơn</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Xử lý lỗi</td>
                        <td style="padding: 10px;">.catch() hoặc .finally()</td>
                        <td style="padding: 10px;">try/catch tiêu chuẩn</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Debug</td>
                        <td style="padding: 10px;">Khó debug hơn</td>
                        <td style="padding: 10px;">Dễ debug hơn</td>
                    </tr>
                </table>
                
                <h2>Ví dụ thực tế: Gọi API với Fetch</h2>
                <p>
                    Hãy xem cách sử dụng Promise và Async/Await với Fetch API, một công cụ phổ biến để gọi API trong JavaScript:
                </p>
                
                <h3>Sử dụng Promise với Fetch</h3>
                <pre><code class="language-javascript">
function getUsers() {
    return fetch('https://api.example.com/users')
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(users => {
            console.log('Users:', users);
            return users;
        })
        .catch(error => {
            console.error('Error fetching users:', error);
            throw error;
        });
}

getUsers()
    .then(users => console.log('Processed users:', users))
    .catch(error => console.error('Error in main flow:', error));
                </code></pre>
                
                <h3>Sử dụng Async/Await với Fetch</h3>
                <pre><code class="language-javascript">
async function getUsers() {
    try {
        const response = await fetch('https://api.example.com/users');
        
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        
        const users = await response.json();
        console.log('Users:', users);
        return users;
    } catch (error) {
        console.error('Error fetching users:', error);
        throw error;
    }
}

async function main() {
    try {
        const users = await getUsers();
        console.log('Processed users:', users);
    } catch (error) {
        console.error('Error in main flow:', error);
    }
}

main();
                </code></pre>
                
                <h2>Kết luận</h2>
                <p>
                    Lập trình bất đồng bộ là một phần không thể thiếu trong JavaScript hiện đại, đặc biệt là trong phát triển web. 
                    Promise và Async/Await là hai công cụ mạnh mẽ giúp chúng ta viết code bất đồng bộ một cách hiệu quả và dễ bảo trì.
                </p>
                
                <p>
                    Mặc dù Async/Await có vẻ đơn giản và dễ sử dụng hơn, nhưng hiểu về Promise vẫn rất quan trọng vì Async/Await được xây 
                    dựng trên nền tảng của Promise. Trong nhiều tình huống, việc kết hợp cả hai kỹ thuật sẽ mang lại kết quả tốt nhất.
                </p>
                
                <p>
                    Trong các bài viết tiếp theo, chúng ta sẽ tìm hiểu sâu hơn về các kỹ thuật xử lý bất đồng bộ nâng cao và ứng dụng 
                    thực tế trong các framework JavaScript hiện đại.
                </p>
                
                <div class="post-tags">
                    <span>#JavaScript</span>
                    <span>#Promise</span>
                    <span>#AsyncAwait</span>
                    <span>#FetchAPI</span>
                    <span>#WebDevelopment</span>
                </div>
                
                <div class="post-navigation">
                    <a href="post-1.html" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Bài trước</a>
                    <a href="post-3.html" class="btn btn-primary">Bài tiếp theo <i class="fas fa-arrow-right"></i></a>
                </div>
            </div>
            
            <div class="author-section">
                <div class="author-avatar">
                    <img src="../images/profile.jpg" alt="Bùi Dương Tin">
                </div>
                <div class="author-info">
                    <h3>Bùi Dương Tin</h3>
                    <p>Lập trình viên với hơn 5 năm kinh nghiệm phát triển ứng dụng Java và JavaScript. Chuyên sâu về lập trình mạng và các công nghệ web hiện đại.</p>
                    <div class="social">
                        <a href="#" target="_blank"><i class="fab fa-github"></i></a>
                        <a href="#" target="_blank"><i class="fab fa-linkedin"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Related Posts -->
    <section class="related-posts">
        <div class="container">
            <h2>Bài viết liên quan</h2>
            <div class="posts-grid">
                <div class="post-card">
                    <div class="post-img">
                        <img src="../images/post-5.jpg" alt="WebSockets">
                        <div class="post-category">JavaScript</div>
                    </div>
                    <div class="post-content">
                        <h3><a href="post-5.html">Tạo ứng dụng real-time với WebSocket và Node.js</a></h3>
                        <div class="post-meta">
                            <span><i class="far fa-calendar"></i> 20/09/2025</span>
                            <span><i class="far fa-clock"></i> 15 phút đọc</span>
                        </div>
                        <p>Hướng dẫn xây dựng ứng dụng real-time với WebSocket, Socket.io và Node.js, tạo chat room và thông báo trực tiếp...</p>
                        <a href="post-5.html" class="read-more">Đọc tiếp <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>

                <div class="post-card">
                    <div class="post-img">
                        <img src="../images/post-9.jpg" alt="JavaScript Performance">
                        <div class="post-category">JavaScript</div>
                    </div>
                    <div class="post-content">
                        <h3><a href="post-9.html">Tối ưu hóa hiệu suất JavaScript trong ứng dụng web</a></h3>
                        <div class="post-meta">
                            <span><i class="far fa-calendar"></i> 20/08/2025</span>
                            <span><i class="far fa-clock"></i> 19 phút đọc</span>
                        </div>
                        <p>Các kỹ thuật tối ưu hóa hiệu suất JavaScript, giảm thiểu tải trang, lazy loading, memoization và các công cụ đo lường hiệu suất...</p>
                        <a href="post-9.html" class="read-more">Đọc tiếp <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <a href="../index.html">BDT<span>Code</span></a>
                    <p>Blog chia sẻ kiến thức lập trình Java và JavaScript, hướng dẫn phát triển ứng dụng mạng.</p>
                </div>
                <div class="footer-links">
                    <h3>Liên kết nhanh</h3>
                    <ul>
                        <li><a href="../index.html">Trang chủ</a></li>
                        <li><a href="../blog.html">Blog</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h3>Liên hệ</h3>
                    <p><i class="fas fa-envelope"></i> info@buiduongtin.com</p>
                    <p><i class="fas fa-phone"></i> +84 123 456 789</p>
                    <div class="social">
                        <a href="#" target="_blank"><i class="fab fa-github"></i></a>
                        <a href="#" target="_blank"><i class="fab fa-linkedin"></i></a>
                        <a href="#" target="_blank"><i class="fab fa-facebook"></i></a>
                        <a href="#" target="_blank"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Bùi Dương Tin. Tất cả các quyền được bảo lưu.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script src="../js/main.js"></script>
</body>
</html>